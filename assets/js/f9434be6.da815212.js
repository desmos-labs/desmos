"use strict";(self.webpackChunkdesmos_docs=self.webpackChunkdesmos_docs||[]).push([[44073],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var s=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,s,i=function(e,t){if(null==e)return{};var n,s,i={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=s.createContext({}),l=function(e){var t=s.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return s.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},d=s.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),d=l(n),h=i,m=d["".concat(c,".").concat(h)]||d[h]||u[h]||o;return n?s.createElement(m,a(a({ref:t},p),{},{components:n})):s.createElement(m,a({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=d;var r={};for(var c in t)hasOwnProperty.call(t,c)&&(r[c]=t[c]);r.originalType=e,r.mdxType="string"==typeof e?e:i,a[1]=r;for(var l=2;l<o;l++)a[l]=n[l];return s.createElement.apply(null,a)}return s.createElement.apply(null,n)}d.displayName="MDXCreateElement"},35292:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>p});n(67294);var s=n(3905);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},i.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,s,i=function(e,t){if(null==e)return{};var n,s,i={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const a={},r="ADR 012: Subspaces sections",c={unversionedId:"architecture/adr-012-subspaces-sections",id:"architecture/adr-012-subspaces-sections",title:"ADR 012: Subspaces sections",description:"Changelog",source:"@site/docs/architecture/adr-012-subspaces-sections.md",sourceDirName:"architecture",slug:"/architecture/adr-012-subspaces-sections",permalink:"/architecture/adr-012-subspaces-sections",draft:!1,editUrl:"https://github.com/desmos-labs/desmos/tree/master/docs/docs/architecture/adr-012-subspaces-sections.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"ADR 011: Reports module",permalink:"/architecture/adr-011-reports-module"},next:{title:"ADR 013: Per-chain default external address",permalink:"/architecture/adr-013-per-chain-default-address"}},l={},p=[{value:"Changelog",id:"changelog",level:2},{value:"Status",id:"status",level:2},{value:"Abstract",id:"abstract",level:2},{value:"Context",id:"context",level:2},{value:"Decision",id:"decision",level:2},{value:"Types",id:"types",level:3},{value:"Section",id:"section",level:4},{value:"<code>Msg</code> Service",id:"msg-service",level:3},{value:"<code>Query</code> Service",id:"query-service",level:3},{value:"Consequences",id:"consequences",level:2},{value:"Backwards Compatibility",id:"backwards-compatibility",level:3},{value:"Positive",id:"positive",level:3},{value:"Negative",id:"negative",level:3},{value:"Neutral",id:"neutral",level:3},{value:"References",id:"references",level:2}],u={toc:p};function d(e){var{components:t}=e,n=o(e,["components"]);return(0,s.kt)("wrapper",i({},u,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",i({},{id:"adr-012-subspaces-sections"}),"ADR 012: Subspaces sections"),(0,s.kt)("h2",i({},{id:"changelog"}),"Changelog"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"May 06th, 2022: Initial draft;"),(0,s.kt)("li",{parentName:"ul"},"May 09th, 2022: Fixed some typos and improved Proto file definitions;")),(0,s.kt)("h2",i({},{id:"status"}),"Status"),(0,s.kt)("p",null,"ACCEPTED Implemented"),(0,s.kt)("h2",i({},{id:"abstract"}),"Abstract"),(0,s.kt)("p",null,"This ADR contains the specific of the new subspaces section, which will allow users to better manage content inside their subspaces."),(0,s.kt)("h2",i({},{id:"context"}),"Context"),(0,s.kt)("p",null,"Currently, the ",(0,s.kt)("inlineCode",{parentName:"p"},"x/subspaces")," module allows to create simple subspaces that are suited to represent applications that display contents inside a single section. An example of this are social applications such as Twitter, where each tweet is put in the same bucket and is not categorized. "),(0,s.kt)("p",null,"Although this allows to create a lot of applications, we are not allowing to easily create forum-like applications where contents are organized in sections, subsections, and so on. This currently requires the developers to create and maintain a very large number of subspaces."),(0,s.kt)("p",null,"Consider, as an example, a forum with 3 sections each one having 3 subsections. This would require the admins to create and manage 9 (one per each subsection) subspaces at the same time. Although technically possible, it would require a lot of duplicated work in some occasions: when a moderator gets elected, for example, it would require the original subspace owner to add it to all 9 subspaces. "),(0,s.kt)("p",null,"This obviously gets more and more complicated very quickly as this kind of applications scale: each time a section (or subsection) needs to be added, a new subspace must be created and managed, making it more complex to operate the whole system."),(0,s.kt)("h2",i({},{id:"decision"}),"Decision"),(0,s.kt)("p",null,"In order to solve the above problems, we will implement a new concept inside the ",(0,s.kt)("inlineCode",{parentName:"p"},"x/subspaces")," module: ",(0,s.kt)("strong",{parentName:"p"},"sections"),". "),(0,s.kt)("p",null,"Each section will represent a portion of a subspace that can have its own user groups and host its own contents. Also, it will be possible to nest sections into one another thanks to parent-children relationships."),(0,s.kt)("pre",null,(0,s.kt)("code",i({parentName:"pre"},{}),"Parent:                    Section P\n                  /            |           \\\nChildren:      Section C1  Section C2  Section C3\n")),(0,s.kt)("p",null,"Permissions inside sections will be inherited from the parent section to all the children sections. Permissions defined in the parent section will have the same permissions also on children sections, but permissions defined in children sections will be valid only there."),(0,s.kt)("p",null,"All subspaces will have a default section having id ",(0,s.kt)("inlineCode",{parentName:"p"},"0")," which identifies the subspace itself. This will be used to define user groups that should be present in all (sub)sections and to post content directly inside the subspace itself."),(0,s.kt)("p",null,"To manage different sections, we will also introduce a new permission inside the ",(0,s.kt)("inlineCode",{parentName:"p"},"x/subspaces")," module: ",(0,s.kt)("inlineCode",{parentName:"p"},"PermissionManageSections")," that will allow users to create, edit and delete a subspace sections as they please."),(0,s.kt)("h3",i({},{id:"types"}),"Types"),(0,s.kt)("h4",i({},{id:"section"}),"Section"),(0,s.kt)("pre",null,(0,s.kt)("code",i({parentName:"pre"},{className:"language-protobuf"}),'syntax = "proto3";\n\n// Section contains the data of a single subspace section\nmessage Section {\n  // Unique id of the section within the subspace\n  uint32 id = 1;\n  \n  // (optional) Id of the parent section\n  uint32 parent_id = 2;\n  \n  // Name of the section within the subspace\n   string name = 3; \n  \n  // (optional) Description of the section\n  string description = 4;\n}\n')),(0,s.kt)("h3",i({},{id:"msg-service"}),(0,s.kt)("inlineCode",{parentName:"h3"},"Msg")," Service"),(0,s.kt)("p",null,"We will allow the following operations: "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"create a new section "),(0,s.kt)("li",{parentName:"ul"},"edit an existing section"),(0,s.kt)("li",{parentName:"ul"},"move a section to another parent"),(0,s.kt)("li",{parentName:"ul"},"delete an existing section")),(0,s.kt)("pre",null,(0,s.kt)("code",i({parentName:"pre"},{className:"language-protobuf"}),'syntax = "proto3";\n\nservice Msg {\n  // CreateSection allows to create a new subspace section\n  rpc CreateSection(MsgCreateSection) returns (MsgCreateSectionResponse);\n  \n  // EditSection allows to edit an existing section\n  rpc EditSection(MsgEditSection) returns (MsgEditSectionResponse);\n  \n  // MoveSection allows to move an existing section to another parent\n  rpc MoveSection(MsgMoveSection) returns (MsgMoveSectionResponse);\n  \n  // DeleteSection allows to delete an existing section\n  rpc DeleteSection(MsgDeleteSection) returns (MsgDeleteSectionResponse);\n}\n\n// MsgCreateSection represents the message to be used when creating a subspace section\nmessage MsgCreateSection {\n  // Id of the subspace inside which the section will be placed\n  uint64 subspace_id = 1;\n  \n  // Name of the section to be created\n  string name = 2;\n  \n  // (optional) Description of the section \n  string description = 3;\n  \n  // (optional) Id of the parent section \n  uint32 parent_id = 4;\n  \n  // User creating the section\n  string creator = 5;\n}\n\n// MsgCreateSectionResponse represents the Msg/CreateSection response type\nmessage MsgCreateSectionResponse {\n  // Id of the newly created section\n  uint32 section_id = 1;\n}\n\n// MsgEditSection represents the message to be used when editing a subspace section\nmessage MsgEditSection {\n  // Id of the subspace inside which the section to be edited is\n  uint64 subspace_id = 1;\n  \n  // Id of the section to be edited\n  uint32 section_id = 2;\n  \n  // (optional) New name of the section\n  string name = 3;\n  \n  // (optional) New description of the section\n  string description = 4;\n  \n  // User editing the section\n  string editor = 5;\n}\n\n// MsgEditSectionResponse represents the Msg/EditSection response type\nmessage MsgEditSectionResponse {}\n\n// MsgMoveSection represents the message to be used when moving a section to another parent\nmessage MsgMoveSection { \n  // Id of the subspace inside which the section lies\n  uint64 subspace_id = 1;\n  \n  // Id of the section to be moved \n  uint32 section_id = 2;\n  \n  // Id of the new parent \n  uint32 new_parent_id = 3;\n  \n  // Signer of the message\n  string signer = 4;\n}\n\n// MsgMoveSectionResponse\nmessage MsgMoveSectionResponse {}\n\n// MsgDeleteSection represents the message to be used when deleting a section\nmessage MsgDeleteSection {\n  // Id of the subspace inside which the section to be deleted is\n  uint64 subspace_id = 1;\n  \n  // Id of the section to delete\n  uint32 section_id = 2;\n  \n  // User deleting the section\n  string signer = 3;\n}\n\n// MsgDeleteSectionResponse represents the Msg/DeleteSection response type\nmessage MsgDeleteSectionResponse {}\n')),(0,s.kt)("h3",i({},{id:"query-service"}),(0,s.kt)("inlineCode",{parentName:"h3"},"Query")," Service"),(0,s.kt)("pre",null,(0,s.kt)("code",i({parentName:"pre"},{className:"language-protobuf"}),'syntax = "proto3";\n\nservice Query {\n  // Sections allows to query for the sections of a specific subspace\n  rpc Sections(QuerySectionsRequest) returns (QuerySectionsResponse) {\n    option (google.api.http).get = "/desmos/subspaces/v2/{subspace_id}/sections";\n  }\n}\n\n// QuerySectionsRequest is the request type for Query/Sections RPC method \nmessage QuerySectionsRequest {\n  // Id of the subspace to query the sections for\n  uint64 subspace_id = 1;\n\n  // pagination defines an optional pagination for the request.\n  cosmos.base.query.v1beta1.PageRequest pagination = 2;\n}\n\n// QuerySectionsResponse is the response type for Query/Sections RPC method \nmessage QuerySectionsResponse {\n  repeated Section sections = 1;\n  cosmos.base.query.v1beta1.PageResponse pagination = 2;\n}\n')),(0,s.kt)("h2",i({},{id:"consequences"}),"Consequences"),(0,s.kt)("h3",i({},{id:"backwards-compatibility"}),"Backwards Compatibility"),(0,s.kt)("p",null,"The changes described inside this ADR are ",(0,s.kt)("strong",{parentName:"p"},"not")," backward compatible. The introduction of subspace sections requires changes inside the ",(0,s.kt)("inlineCode",{parentName:"p"},"x/subspaces")," module as well as inside the upcoming ",(0,s.kt)("inlineCode",{parentName:"p"},"x/posts")," module. In particular, permission management and post creation need to be adapted accordingly."),(0,s.kt)("p",null,"User groups need to be assigned to a specific section instead of a subspace, and users need to be able to assign permissions within a specific section as well. "),(0,s.kt)("p",null,"Also, posts will need to be put inside a particular section (by default the ",(0,s.kt)("inlineCode",{parentName:"p"},"0")," one), and not a generic subspace only. To do this, when creating a post users will have to specify the section id along with the subspace id."),(0,s.kt)("h3",i({},{id:"positive"}),"Positive"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"DApp developers will be able to manage the contents of their apps more easily"),(0,s.kt)("li",{parentName:"ul"},"Subspace sections will allow to create forum-like applications, opening up Desmos to even more use cases")),(0,s.kt)("h3",i({},{id:"negative"}),"Negative"),(0,s.kt)("h3",i({},{id:"neutral"}),"Neutral"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Changes are required to both the ",(0,s.kt)("inlineCode",{parentName:"li"},"x/subspaces")," as well as the ",(0,s.kt)("inlineCode",{parentName:"li"},"x/posts")," modules")),(0,s.kt)("h2",i({},{id:"references"}),"References"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Issue ",(0,s.kt)("a",i({parentName:"li"},{href:"https://github.com/desmos-labs/desmos/issues/856"}),"#856"),".")))}d.isMDXComponent=!0}}]);